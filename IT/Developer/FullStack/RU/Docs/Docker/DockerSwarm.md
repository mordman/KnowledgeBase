**Docker Swarm** — это встроенный инструмент оркестрации контейнеров от Docker, который позволяет управлять кластером Docker-хостов как единой системой. Он упрощает развёртывание, масштабирование и управление контейнерами в распределённой среде.

---

## **Зачем нужен Docker Swarm?**
- **Кластеризация**: Объединяет несколько Docker-хостов в единый кластер.
- **Масштабируемость**: Позволяет легко масштабировать приложения, добавляя или удаляя контейнеры.
- **Отказоустойчивость**: Автоматически восстанавливает контейнеры при сбоях.
- **Балансировка нагрузки**: Равномерно распределяет трафик между контейнерами.
- **Простота использования**: Встроен в Docker, не требует дополнительных инструментов.

---

## **Основные понятия Docker Swarm**
- **Узел (Node)**: Физическая или виртуальная машина, на которой запущен Docker. Бывают:
  - **Менеджер (Manager)**: Управляет кластером, планирует задачи.
  - **Рабочий узел (Worker)**: Исполняет задачи, запускает контейнеры.
- **Сервис (Service)**: Описание задачи, которую нужно выполнить (например, запустить 3 реплики веб-сервера).
- **Задача (Task)**: Конкретный экземпляр контейнера, запущенный как часть сервиса.
- **Стек (Stack)**: Набор сервисов, описанных в файле `docker-compose.yml`.

---

## **Как использовать Docker Swarm?**

### **1. Инициализация кластера**
На **менеджер-узле** выполните команду:
```bash
docker swarm init --advertise-addr <IP-адрес_менеджера>
```
Эта команда создаст кластер и выведет команду для подключения рабочих узлов.

---

### **2. Подключение рабочих узлов**
На **рабочем узле** выполните команду, которую выдал `docker swarm init`:
```bash
docker swarm join --token <токен> <IP-адрес_менеджера>:2377
```

---

### **3. Проверка состояния кластера**
На менеджере:
```bash
docker node ls
```
Эта команда покажет все узлы в кластере и их статус.

---

### **4. Развёртывание сервиса**
Создайте сервис (например, веб-сервер Nginx):
```bash
docker service create --name my-web --replicas 3 -p 80:80 nginx
```
- `--name my-web`: Имя сервиса.
- `--replicas 3`: Запустить 3 реплики контейнера.
- `-p 80:80`: Пробросить порт 80.

---

### **5. Проверка развёрнутого сервиса**
```bash
docker service ls
docker service ps my-web
```
Эти команды покажут список сервисов и задачи, связанные с сервисом `my-web`.

---

### **6. Масштабирование сервиса**
Увеличьте количество реплик:
```bash
docker service scale my-web=5
```

---

### **7. Обновление сервиса**
Обновите образ контейнера:
```bash
docker service update --image nginx:latest my-web
```

---

### **8. Удаление сервиса**
```bash
docker service rm my-web
```

---

### **9. Использование Docker Compose с Swarm**
Можно развернуть стек сервисов с помощью `docker-compose.yml`:
```bash
docker stack deploy -c docker-compose.yml my-stack
```
Пример `docker-compose.yml`:
```yaml
version: "3.8"
services:
  web:
    image: nginx
    deploy:
      replicas: 3
    ports:
      - "80:80"
```

---

### **10. Управление кластером**
- **Просмотр логов**:
  ```bash
  docker service logs my-web
  ```
- **Просмотр сетевых ресурсов**:
  ```bash
  docker network ls
  ```
- **Удаление узла из кластера**:
  ```bash
  docker swarm leave  # На рабочем узле
  docker node rm <ID_узла>  # На менеджере
  ```

---

## **Преимущества Docker Swarm**
- **Простота**: Легко настроить и использовать.
- **Интеграция с Docker**: Не требует изучения новых инструментов.
- **Отказоустойчивость**: Автоматическое восстановление контейнеров.
- **Балансировка нагрузки**: Встроенная поддержка распределения трафика.

---

## **Недостатки Docker Swarm**
- **Ограниченная функциональность**: Меньше возможностей по сравнению с Kubernetes.
- **Масштабируемость**: Плохо подходит для очень крупных кластеров.
- **Экосистема**: Меньше плагинов и интеграций, чем у Kubernetes.

---

## **Когда использовать Docker Swarm?**
- Для небольших и средних проектов.
- Если уже используете Docker и не хотите усложнять инфраструктуру.
- Если нужна простая и быстрая оркестрация контейнеров.

---